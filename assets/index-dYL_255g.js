(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();class T{constructor(t,o,i,n,r,l="",p=-1){this._title=t,this._description=o,i?this._dueDate=new Date(i):this._dueDate="",this._priority=n,this._finished=r,this._parentTitle=l,this._todoId=p}get todoId(){return this._todoId}set todoId(t){this._todoId=t}toPlainObject(){return{title:this._title,description:this._description,dueDate:this._dueDate,priority:this._priority,finished:this._finished,parentTitle:this._parentTitle,todoId:this._todoId}}static fromPlainObject(t){return new T(t.title,t.description,t.dueDate,t.priority,t.finished,t.parentTitle,t.todoId)}isDue(){if(this._dueDate){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())>this._dueDate}return!1}get title(){return this._title}set title(t){this._title=t}get parentTitle(){return this._parentTitle}set parentTitle(t){this._parentTitle=t}get description(){return this._description}set description(t){this._description=t}get dueDate(){return this._dueDate}set dueDate(t){this._dueDate=t}get priority(){return this._priority}set priority(t){this._priority=t}get finished(){return this._finished}set finished(t){this._finished=t}}class a{constructor(t,o=!0,i=!1,n=[]){this._title=t,this._deletable=o,this._isAddingRestricted=i,this._todos=n}reorderTodos(){this._todos.forEach((t,o)=>{t.todoId=o})}toPlainObject(){return{title:this._title,deletable:this._deletable,isAddingRestricted:this._isAddingRestricted,todos:this.nestedObjectToPlain()}}nestedObjectToPlain(){return this._todos.map(t=>{if(t instanceof T)return t.toPlainObject()})}static fromPlainObject(t){const o=t.todos.map(i=>T.fromPlainObject(i));return new a(t.title,t.deletable,t.isAddingRestricted,o)}addTodo(t){t.parentTitle=this._title,this._todos.unshift(t),this.reorderTodos()}removeTodo(t){this._todos.splice(t,1),this.reorderTodos()}get isAddingRestricted(){return this._isAddingRestricted}get deletable(){return this._deletable}get todos(){return this._todos}get unfinishedTodos(){return this._todos.filter(t=>!t.finished)}getTodos(){if(!this.isEmpty())return this.todos}set todos(t){this._todos=t}get title(){return this._title}getTodo(t){return this._todos[t]}isEmpty(){return this._todos.length===0}}class P{constructor(t=[]){this._todoProjects=t}toPlainObject(){return{todoProjects:this.nestedObjectToPlain()}}nestedObjectToPlain(){return this._todoProjects.map(t=>{if(t instanceof a)return t.toPlainObject()})}static fromPlainObject(t){const o=t.todoProjects.map(i=>a.fromPlainObject(i));return new P(o)}addTodoProject(t){this.getTodoProjectByTitle(t.title)||this._todoProjects.push(t)}removeTodoProject(t){this._todoProjects.splice(t,1)}removeTodoProjectByName(t){for(let o=0;o<this._todoProjects.length;o++)if(this._todoProjects[o].title===t){this.removeTodoProject(o);break}}get todoProjects(){return this._todoProjects}getTodoProjectById(t){return this._todoProjects[t]}getTodoProjectByTitle(t){if(t&&this.projectExists(t)){let o;for(let i of this._todoProjects)if(i.title===t){o=i;break}return o}}projectExists(t){for(let o of this._todoProjects)if(o.title===t)return!0;return!1}get allTodos(){let t=[];return this._todoProjects.forEach(o=>{!o.isEmpty()&&!o.isAddingRestricted&&(t=[...t,...o.todos])}),t}get allUnfinishedTodos(){return this.allTodos.filter(t=>!t.finished)}}let u="Home";const v=new Date,W=new Date(v.getFullYear(),v.getMonth(),v.getDate());let d=new P,M=new a("Home",!1),S=new a("Today",!1,!0),w=new a("Week",!1,!0);d.addTodoProject(M);d.addTodoProject(S);d.addTodoProject(w);function J(e){e.finished=!e.finished,y(),f()}function U(e){u=e,f()}function B(e){e===u&&(u="Home"),d.removeTodoProjectByName(e),y(),f()}function Y(e){e&&(d.addTodoProject(new a(e)),u=e,y(),f())}function K(e,t,o,i){d.getTodoProjectByTitle(u).addTodo(new T(e,t,o,i)),console.log(new T(e,t,o,i)),y(),f()}function z(e,t){d.getTodoProjectByTitle(e).removeTodo(t),y(),f()}function x(e){let t=e*24*60*60*1e3;return function(o){if(o.dueDate){let i=o.dueDate-W;return i>0&&i<t}return!1}}let G=x(1),Q=x(7);function y(){S.todos=d.allTodos.filter(G),w.todos=d.allTodos.filter(Q),V()}function V(){const e=JSON.stringify(d.toPlainObject());localStorage.setItem("todosList",e)}function X(){if(localStorage.getItem("todosList")){let e=JSON.parse(localStorage.getItem("todosList"));d=P.fromPlainObject(e),M=d.getTodoProjectByTitle("Home"),S=d.getTodoProjectByTitle("Today"),w=d.getTodoProjectByTitle("Week"),y()}}X();const c=document.querySelector("#app"),H=c.querySelector("#overview"),R=c.querySelector("#projects"),D=c.querySelector("#todos-list"),Z=c.querySelector(".add-project"),C=c.querySelector("#project-dialog"),A=C.querySelector("form"),tt=C.querySelector("#project-name-input"),et=document.querySelectorAll(".modal-close-btn"),k=c.querySelector("#add-todo"),h=c.querySelector("#add-dialog"),I=h.querySelector("form"),ot=h.querySelector("#todo-title-input"),it=h.querySelector("#todo-details-input"),nt=h.querySelector("#todo-duedate-input"),st=h.querySelectorAll('input[name="priority"]'),q=c.querySelector("#warn-dialog"),rt=q.querySelector("#remove-project"),L=document.querySelector(".hamburger-button"),E=document.querySelector(".primary-nav"),j=c.querySelector("#details-dialog");let O="";function s(e,t=[],o=""){const i=document.createElement(e);return i.innerText=o,i.classList.add(...t),i}function m(e,...t){t.forEach(o=>{e.appendChild(o)})}function dt(e){e.style.display="none"}function lt(e){e.style.display="block"}function N(e){if(!e)return;let t=e.getDate(),o=e.getMonth()+1,i="";switch(e.getDay()){case 0:i="Sun";break;case 1:i="Mon";break;case 2:i="Tue";break;case 3:i="Wed";break;case 4:i="Thr";break;case 5:i="Fri";break;case 6:i="Sat";break}return`${i} ${t}. ${o}.`}function ct(e){const t=s("div",["todo","flex-repel"]),o=s("div",["todo__content"]),i=s("div",["todo-actions","flex-group"]),n=s("input"),r=s("div",["todo__info"]),l=s("div",["todo-details"]),p=s("div",["todo-title"],`${e.title}`),b=s("span",["todo-duedate"],N(e.dueDate)),g=s("button",["icon-button"]);g.innerHTML='<span class="material-symbols-outlined icon">info</span>';const _=s("button",["icon-button"]);if(_.innerHTML='<span class="material-symbols-outlined icon">delete</span>',t.setAttribute("data-priority",e.priority),n.setAttribute("type","checkbox"),e.finished&&n.setAttribute("checked",!0),e.isDue()&&!e.finished&&l.classList.add("due"),o.appendChild(n),!d.getTodoProjectByTitle(u).deletable){const $=s("span",["todo-parent"],`${e.parentTitle}, `);l.appendChild($)}return l.appendChild(b),m(r,p,l),o.appendChild(r),i.appendChild(g),i.appendChild(_),m(t,o,i),n.addEventListener("click",()=>J(e)),g.addEventListener("click",()=>_t(e)),_.addEventListener("click",()=>z(e.parentTitle,e.todoId)),t}function at(e){e.forEach(t=>{D.appendChild(ct(t))})}function ut(e){const t=s("h2",["project-header"],e.title);D.appendChild(t)}function pt(e){const t=s("div",["empty-project"]);t.innerHTML="<p>This project is empty</p>";const o=s("div",["empty-project-buttons"]);if(e.deletable){const i=s("button",["button-outline"],"Remove");i.addEventListener("click",()=>B(e.title)),o.appendChild(i)}if(e.isAddingRestricted)t.innerHTML="<p>No reason to stress</p>";else{const i=s("button",["button-fill"],"Create todo");i.addEventListener("click",()=>{h.showModal()}),o.appendChild(i)}t.appendChild(o),D.appendChild(t)}function ht(e,t){if(t){let o=[],i=e.getTodoProjectByTitle(t);t==="Home"?o=e.allTodos:(i.isAddingRestricted&&dt(k),i.isEmpty()||(o=[...o,...i.todos])),ut(i),o.length!==0?at(o):pt(i)}}function ft(e,t){e.stopPropagation(),d.getTodoProjectByTitle(t).isEmpty()?B(t):(O=t,q.showModal())}function mt(e){const t=s("li"),o=s("button",["project-button","flex-repel"]),i=s("span",["button-content"]),n=s("span",["button-text"],e.title),r=s("span",["todos-count"],e.unfinishedTodos.length);if(o.setAttribute("data-project-name",e.title),e.title==="Home"&&(r.innerText=d.allUnfinishedTodos.length),+r.innerText==0?r.style.display="none":+r.innerText>9&&(r.innerText="+9"),m(i,n,r),o.appendChild(i),o.addEventListener("click",()=>{F(),U(e.title)}),t.appendChild(o),e.deletable){const l=s("span",["delete-project"]);l.innerHTML='<span class="material-symbols-outlined icon"> close </span>',l.setAttribute("data-project-name",e.title),l.addEventListener("click",p=>ft(p,e.title)),o.appendChild(l)}return t}function Tt(e){const t=s("ul",["projects"]),o=s("ul",["projects","project--permanent"]);e.todoProjects.forEach(i=>{let n=mt(i);i.deletable?t.appendChild(n):o.appendChild(n)}),H.appendChild(o),R.appendChild(t)}function yt(){D.innerHTML="",R.innerHTML="",H.innerHTML=""}function gt(){document.querySelector(`[data-project-name="${u}"]`).classList.add("active")}function f(){yt(),lt(k),Tt(d),ht(d,u),gt()}document.addEventListener("DOMContentLoaded",()=>{f()});et.forEach(e=>{e.addEventListener("click",t=>{let o=t.currentTarget.closest("dialog"),i=o.querySelector("form");i&&i.reset(),o.close()})});function _t(e){j.querySelector(".dialog-header").innerText=`Todo: ${e.title}`;const t=j.querySelector(".dialog-body");t.innerHTML="";const o=s("div"),i=s("h3",[],"Description:"),n=s("p",[],e.description);m(o,i,n),e.description&&t.appendChild(o);const r=s("div"),l=s("h3",[],"Project:"),p=s("p",[],e.parentTitle);m(r,l,p),t.appendChild(r);const b=s("div"),g=s("h3",[],"Due date:"),_=s("p",[],N(e.dueDate));m(b,g,_),e.dueDate&&t.appendChild(b),j.showModal()}Z.addEventListener("click",()=>{C.showModal()});A.addEventListener("submit",e=>{let t=tt.value.trim();d.projectExists(t)?(alert("Project with this name already exists"),e.preventDefault()):(F(),Y(t),A.reset())});k.addEventListener("click",()=>{h.showModal()});I.addEventListener("submit",()=>{let e=ot.value,t=it.value,o=nt.value,i="unset";for(let n of st)n.checked&&(i=n.value);K(e,t,o,i),I.reset()});rt.addEventListener("click",()=>{B(O),q.close()});L.addEventListener("click",()=>{L.classList.toggle("active"),E.setAttribute("aria-expanded",E.getAttribute("aria-expanded")==="false"?"true":"false")});function F(){L.classList.remove("active"),E.setAttribute("aria-expanded","false")}
